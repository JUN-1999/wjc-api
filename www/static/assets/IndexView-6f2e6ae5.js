import{aE as $,d as E,aK as g,e as U,N as x,c as m,a as e,f as C,w as S,aL as w,h as F,aF as k,o as r,_ as D,t as I,F as N,r as M,b as p,ai as L,v as b,j as H,aM as P}from"./index-93692fea.js";import{g as z}from"./article-92a99f26.js";import{E as B}from"./el-image-viewer-24ab5b0e.js";const j=o=>$("/treehole/comment/sendComment",{method:"post",data:o}),q=o=>$("/treehole/comment/commentList",{method:"get",params:o}),J={class:"comment-input"},K={class:"avatar"},G=["src"],Q=E({__name:"CommentInput",props:{articleuuid:{default:""},toUserUUID:{default:""},toUserName:{default:""},fatherCommentUUID:{default:""}},emits:["successComment"],setup(o,{emit:v}){const a=o,s=g(),l="留下你精彩的评论吧",t=U(""),A=U(!1),d=U(!1);x(t,(n,u)=>{n?d.value=!0:d.value=!1});const f=async()=>{var n,u,c;if(t.value=="")k({message:"评论不能为空",type:"warning"});else{const _=t.value,i={AVATAR:(n=s.userInfo)==null?void 0:n.AVATAR,COMMENT:_,ADD_TIME:"刚刚",ACCOUNT:(u=s.userInfo)==null?void 0:u.ACCOUNT,COMMENT_UUID:Date.now()+"",ARTICLE_UUID:a.articleuuid,USER_UUID:(c=s.userInfo)==null?void 0:c.USER_UUID,USERINFO:{ACCOUNT:a.toUserName,AVATAR:""}};await j({to_user_uuid:a.toUserUUID,father_comment_uuid:a.fatherCommentUUID,comment:_,article_uuid:a.articleuuid}),t.value="",A.value=!0,v("successComment",i)}};return(n,u)=>{var c;return r(),m("div",J,[e("div",K,[e("img",{src:(c=C(s).userInfo)==null?void 0:c.AVATAR,alt:""},null,8,G)]),S(e("input",{placeholder:l,class:"comment_input","onUpdate:modelValue":u[0]||(u[0]=_=>t.value=_),ref:"content"},null,512),[[w,t.value]]),e("div",{class:F(["comment_input_right",d.value?"can-send":"not-can-send"]),onClick:f}," 发送 ",2)])}}});const V=D(Q,[["__scopeId","data-v-4e0bb45e"]]),W={class:"acticle-info"},X={class:"left"},Y=["src"],Z={class:"right"},ee={class:"name"},te={class:"time"},se={class:"content"},oe=["innerHTML"],ne={class:"imgs"},ce=E({__name:"ArticleInfo",props:{articleInfo:null},setup(o){return(v,a)=>{const s=B;return r(),m("div",W,[e("div",X,[e("div",null,[e("img",{src:o.articleInfo.AVATAR},null,8,Y)])]),e("div",Z,[e("div",ee,I(o.articleInfo.ACCOUNT),1),e("div",te,I(o.articleInfo.UPDATE_TIME||o.articleInfo.ADD_TIME),1),e("div",se,[e("p",{innerHTML:o.articleInfo.CONTENT},null,8,oe)]),e("div",ne,[(r(!0),m(N,null,M(o.articleInfo.PICS,(l,t)=>(r(),m("div",{key:t,class:"img-box"},[p(s,{class:"img-item",fit:"cover",src:l.url,"preview-src-list":[l.url],"zoom-rate":1.1},null,8,["src","preview-src-list","zoom-rate"])]))),128))])])])}}});const ae=D(ce,[["__scopeId","data-v-bb1433af"]]),le={class:"left"},ie={class:"avatar"},_e=["src"],me={class:"right"},re={class:"name"},ue={key:0,class:"at"},de={class:"comment"},Ue={class:"tool"},Ce={class:"tool-item time"},Ie=["onClick"],ve=E({__name:"CommentMinorList",props:{commentList:null},emits:["minorReply"],setup(o,{emit:v}){const a=s=>{v("minorReply",s.FATHER_COMMENT_UUID,s.USER_UUID,s.ACCOUNT)};return(s,l)=>(r(),m("div",null,[(r(!0),m(N,null,M(o.commentList,(t,A)=>(r(),m("div",{class:"comment-item",key:A},[e("div",le,[e("div",ie,[e("img",{src:t.AVATAR,alt:""},null,8,_e)])]),e("div",me,[e("div",null,[e("span",re,I(t.ACCOUNT),1),t.USERINFO?(r(),m("span",ue,"@"+I(t.USERINFO.ACCOUNT)+" ：",1)):L("",!0),e("span",de,I(t.COMMENT),1)]),e("div",Ue,[e("span",Ce,I(s.$common.timeFilter(t.ADD_TIME)),1),e("span",{class:"tool-item reply",onClick:d=>a(t)},"回复",8,Ie)])])]))),128))]))}});const Ae=D(ve,[["__scopeId","data-v-5c2e2631"]]),pe={class:"commont-list"},fe={class:"left"},Te={class:"avatar"},he=["src"],Ee={class:"right"},De={class:"name"},Ne={class:"content"},Me={class:"tool"},Oe={class:"tool-item time"},Re=["onClick"],ye={key:0,style:{"margin-left":"0px","padding-top":"10px"}},$e=E({__name:"CommontList",props:{commentList:null,articleuuid:null},emits:["minorSuccessComment"],setup(o,{emit:v}){const a=o,s=g();let l=U(),t=U(""),A=U(""),d=U("");const f=c=>{l.value?l.value="":(l.value=c.COMMENT_UUID,t.value="",d.value=c.COMMENT_UUID)},n=(c,_,i)=>{l.value?l.value="":(l.value=c,t.value=_,A.value=i,d.value=c)},u=(c,_)=>{var T,h,O,R,y;const i={AVATAR:(T=s.userInfo)==null?void 0:T.AVATAR,COMMENT:_.COMMENT,ADD_TIME:"刚刚",ACCOUNT:(h=s.userInfo)==null?void 0:h.ACCOUNT,COMMENT_UUID:Date.now()+"",ARTICLE_UUID:a.articleuuid,USER_UUID:(O=s.userInfo)==null?void 0:O.USER_UUID,TO_USER_UUID:_.TO_USER_UUID,FATHER_COMMENT_UUID:_.FATHER_COMMENT_UUID,USERINFO:{ACCOUNT:(R=_.USERINFO)==null?void 0:R.ACCOUNT,AVATAR:(y=_.USERINFO)==null?void 0:y.AVATAR}};v("minorSuccessComment",c,i)};return(c,_)=>(r(),m("div",pe,[(r(!0),m(N,null,M(o.commentList,(i,T)=>(r(),m("div",{class:"comment-item",key:T},[e("div",fe,[e("div",Te,[e("img",{src:i.AVATAR,alt:""},null,8,he)])]),e("div",Ee,[e("div",De,I(i.ACCOUNT),1),e("div",Ne,I(i.COMMENT),1),e("div",Me,[e("span",Oe,I(c.$common.timeFilter(i.ADD_TIME)),1),e("span",{class:"tool-item reply",onClick:h=>f(i)},"回复",8,Re)]),i.childComment?(r(),m("div",ye,[p(Ae,{onMinorReply:n,commentList:i.childComment},null,8,["commentList"])])):L("",!0),S(p(V,{class:"minor-reply",onSuccessComment:h=>{u(T,h)},articleuuid:i.ARTICLE_UUID,toUserUUID:C(t),toUserName:C(A),fatherCommentUUID:C(d)},null,8,["onSuccessComment","articleuuid","toUserUUID","toUserName","fatherCommentUUID"]),[[b,C(l)===i.COMMENT_UUID]])])]))),128))]))}});const ge=D($e,[["__scopeId","data-v-f37f59fd"]]),Se={class:"article-detail"},Le={class:"comment-box"},Ve=E({__name:"IndexView",setup(o){const v=P();let a=U(""),s=U([]),l=U({ACCOUNT:"",ADD_TIME:"",ARTICLE_UUID:"",AVATAR:"",CONTENT:"",PICS:"",TITLE:"",UPDATE_TIME:""});H(()=>{a.value=v.params.id,A(),t()});const t=async()=>{const n=await q({article_uuid:a.value});s.value=n.data},A=async()=>{const n=await z({article_uuid:a.value});n.data.PICS=JSON.parse(n.data.PICS),l.value=n.data},d=async n=>{s.value.unshift(n)},f=async(n,u)=>{var c;(c=s.value[n].childComment)==null||c.push(u)};return(n,u)=>(r(),m("div",Se,[p(ae,{articleInfo:C(l)},null,8,["articleInfo"]),e("div",Le,[p(V,{onSuccessComment:d,articleuuid:C(a)},null,8,["articleuuid"])]),p(ge,{commentList:C(s),articleuuid:C(a),onMinorSuccessComment:f},null,8,["commentList","articleuuid"])]))}});const ke=D(Ve,[["__scopeId","data-v-e98c0a50"]]);export{ke as default};
