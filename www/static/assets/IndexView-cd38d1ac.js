import{aF as L,d as h,aI as R,e as m,Q as S,c as i,w as A,v as N,a as e,aJ as $,t as d,aK as w,o as r,m as v,F as D,r as M,aj as g,_ as y,b as f,f as I,j as V,aL as k}from"./index-df65ba1e.js";import{g as P}from"./article-dffdec7a.js";const b=o=>L("/treehole/comment/sendComment",{method:"post",data:o}),F=o=>L("/treehole/comment/commentList",{method:"get",params:o}),H={class:"comment-input"},B={class:"comment_input_box"},x=h({__name:"CommentInput",props:{articleuuid:null,toUserUUID:null,fatherCommentUUID:null},emits:["successComment"],setup(o,{emit:a}){const s=o,n=R(),_="留下你精彩的评论吧",t=m(""),p=m(!1),l=m(!1),c=m(!0);S(t,(C,U)=>{C?l.value=!0:l.value=!1});const u=async()=>{var C,U,T;if(t.value=="")w({message:"评论不能为空",type:"warning"});else{const E=t.value,O={AVATAR:(C=n.userInfo)==null?void 0:C.AVATAR,COMMENT:E,ADD_TIME:"刚刚",ACCOUNT:(U=n.userInfo)==null?void 0:U.ACCOUNT,COMMENT_UUID:Date.now()+"",ARTICLE_UUID:s.articleuuid,USER_UUID:(T=n.userInfo)==null?void 0:T.USER_UUID};await b({to_user_uuid:s.toUserUUID,father_comment_uuid:s.fatherCommentUUID,comment:E,article_uuid:s.articleuuid}),t.value="",p.value=!0,a("successComment",O)}};return(C,U)=>(r(),i("div",H,[A(e("div",B,[A(e("input",{placeholder:_,class:"comment_input","onUpdate:modelValue":U[0]||(U[0]=T=>t.value=T),ref:"content"},null,512),[[$,t.value]]),e("div",{class:"comment_input_right",onClick:u}," 发送评论【"+d(l.value?"可以发送":"不能发送")+"】 ",1)],512),[[N,c.value]])]))}}),j=["src"],J=["innerHTML"],q=["src"],K=h({__name:"ArticleInfo",props:{articleInfo:null},setup(o){return(a,s)=>(r(),i("div",null,[e("div",null," 发布者："+d(o.articleInfo.ACCOUNT),1),e("div",null,[v("头像："),e("img",{style:{width:"50px",height:"50px"},src:o.articleInfo.AVATAR},null,8,j)]),e("div",null,[v("内容： "),e("p",{innerHTML:o.articleInfo.CONTENT},null,8,J)]),e("div",null,[v("图片： "),(r(!0),i(D,null,M(o.articleInfo.PICS,(n,_)=>(r(),i("img",{style:{width:"50px",height:"50px"},key:_,src:n.url},null,8,q))),128))])]))}}),Q=["src"],z={key:0},G=["onClick"],W=h({__name:"CommentMinorList",props:{commentList:null},emits:["minorReply"],setup(o,{emit:a}){m();const s=n=>{a("minorReply",n.FATHER_COMMENT_UUID,n.USER_UUID)};return(n,_)=>(r(),i("div",null,[(r(!0),i(D,null,M(o.commentList,(t,p)=>(r(),i("div",{class:"comment",key:p},[e("div",null,[v("头像："),e("img",{src:t.AVATAR,alt:""},null,8,Q)]),t.USERINFO?(r(),i("div",z,[v(" @"),e("span",null,d(t.USERINFO.ACCOUNT),1)])):g("",!0),e("div",null,"昵称："+d(t.ACCOUNT),1),e("div",null,"内容："+d(t.COMMENT),1),e("div",null,[v("时间："+d(t.ADD_TIME)+" ",1),e("span",{class:"reply",onClick:l=>s(t)},"回复",8,G)])]))),128))]))}});const X=y(W,[["__scopeId","data-v-396bdc2c"]]),Y=["src"],Z=["onClick"],ee={key:0,style:{"margin-left":"20px"}},te=h({__name:"CommontList",props:{commentList:null},setup(o){let a=m(),s=m(""),n=m("");const _=l=>{a.value?a.value="":(a.value=l.COMMENT_UUID,s.value="",n.value=l.COMMENT_UUID)},t=(l,c)=>{a.value?a.value="":(a.value=l,s.value=c,n.value=l)},p=(l,c)=>{console.log(l,c)};return(l,c)=>(r(),i("div",null,[v(" 评论列表 "),(r(!0),i(D,null,M(o.commentList,(u,C)=>(r(),i("div",{class:"comment",key:C},[e("div",null,[v("头像："),e("img",{src:u.AVATAR,alt:""},null,8,Y)]),e("div",null,"昵称："+d(u.ACCOUNT),1),e("div",null,"内容："+d(u.COMMENT),1),e("div",null,[v("时间："+d(u.ADD_TIME)+" ",1),e("span",{class:"reply",onClick:U=>_(u)},"回复",8,Z)]),u.childComment?(r(),i("div",ee,[f(X,{onMinorReply:t,commentList:u.childComment},null,8,["commentList"])])):g("",!0),A(f(x,{onSuccessComment:U=>p(C,u),articleuuid:u.ARTICLE_UUID,toUserUUID:I(s),fatherCommentUUID:I(n)},null,8,["onSuccessComment","articleuuid","toUserUUID","fatherCommentUUID"]),[[N,I(a)===u.COMMENT_UUID]])]))),128))]))}});const ne=y(te,[["__scopeId","data-v-730d6601"]]),se={class:"article-detail"},oe={class:"comment-box"},le=h({__name:"IndexView",setup(o){const a=k();let s=m(""),n=m([]),_=m({ACCOUNT:"",ADD_TIME:"",ARTICLE_UUID:"",AVATAR:"",CONTENT:"",PICS:"",TITLE:"",UPDATE_TIME:""});V(()=>{s.value=a.params.id,p(),t()});const t=async()=>{const c=await F({article_uuid:s.value});n.value=c.data},p=async()=>{const c=await P({article_uuid:s.value});c.data.PICS=JSON.parse(c.data.PICS),_.value=c.data},l=async c=>{n.value.unshift(c)};return(c,u)=>(r(),i("div",se,[f(K,{articleInfo:I(_)},null,8,["articleInfo"]),e("div",oe,[f(x,{onSuccessComment:l,articleuuid:I(s)},null,8,["articleuuid"])]),f(ne,{commentList:I(n)},null,8,["commentList"])]))}});const ue=y(le,[["__scopeId","data-v-c6fb5cfd"]]);export{ue as default};
