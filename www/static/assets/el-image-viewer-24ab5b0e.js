import{s as W,aN as _e,z as ne,y as Ee,aO as Le,W as pe,Y as ie,ap as ge,am as fe,d as se,aP as de,aQ as Ce,aR as Te,aS as ye,a1 as we,aT as ze,e as T,aU as xe,ar as Se,P as z,N as le,ab as he,j as be,o as L,m as ue,b as g,ag as S,a as E,h as w,f as t,i as ce,ay as Ne,ai as N,av as Y,aV as Oe,c as V,F as ae,aW as $e,aX as Re,aY as Ae,aZ as Be,ah as Me,a_ as Ve,a$ as Ye,r as We,w as Xe,v as Fe,a5 as te,b0 as Pe,b1 as De,a6 as ke,b2 as Z,b3 as j,b4 as He,ak as Ie,aq as je,t as Ze,aw as Ue,b5 as qe,$ as Ge,b6 as Ke}from"./index-93692fea.js";import{u as Qe}from"./article-92a99f26.js";const Je=(n,r)=>{if(!W||!n||!r)return!1;const a=n.getBoundingClientRect();let o;return r instanceof Element?o=r.getBoundingClientRect():o={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},a.top<o.bottom&&a.bottom>o.top&&a.right>o.left&&a.left<o.right};var et=/\s/;function tt(n){for(var r=n.length;r--&&et.test(n.charAt(r)););return r}var nt=/^\s+/;function at(n){return n&&n.slice(0,tt(n)+1).replace(nt,"")}var me=0/0,st=/^[-+]0x[0-9a-f]+$/i,rt=/^0b[01]+$/i,ot=/^0o[0-7]+$/i,it=parseInt;function ve(n){if(typeof n=="number")return n;if(_e(n))return me;if(ne(n)){var r=typeof n.valueOf=="function"?n.valueOf():n;n=ne(r)?r+"":r}if(typeof n!="string")return n===0?n:+n;n=at(n);var a=rt.test(n);return a||ot.test(n)?it(n.slice(2),a?2:8):st.test(n)?me:+n}var lt=function(){return Ee.Date.now()};const re=lt;var ut="Expected a function",ct=Math.max,ft=Math.min;function dt(n,r,a){var o,c,h,i,v,y,b=0,k=!1,p=!1,d=!0;if(typeof n!="function")throw new TypeError(ut);r=ve(r)||0,ne(a)&&(k=!!a.leading,p="maxWait"in a,h=p?ct(ve(a.maxWait)||0,r):h,d="trailing"in a?!!a.trailing:d);function m(l){var I=o,R=c;return o=c=void 0,b=l,i=n.apply(R,I),i}function f(l){return b=l,v=setTimeout($,r),k?m(l):i}function X(l){var I=l-y,R=l-b,P=r-I;return p?ft(P,h-R):P}function O(l){var I=l-y,R=l-b;return y===void 0||I>=r||I<0||p&&R>=h}function $(){var l=re();if(O(l))return D(l);v=setTimeout($,X(l))}function D(l){return v=void 0,d&&o?m(l):(o=c=void 0,i)}function F(){v!==void 0&&clearTimeout(v),b=0,o=y=c=v=void 0}function U(){return v===void 0?i:D(re())}function x(){var l=re(),I=O(l);if(o=arguments,c=this,y=l,I){if(v===void 0)return f(y);if(p)return clearTimeout(v),v=setTimeout($,r),m(y)}return v===void 0&&(v=setTimeout($,r)),i}return x.cancel=F,x.flush=U,x}var mt="Expected a function";function oe(n,r,a){var o=!0,c=!0;if(typeof n!="function")throw new TypeError(mt);return ne(a)&&(o="leading"in a?!!a.leading:o,c="trailing"in a?!!a.trailing:c),dt(n,r,{leading:o,maxWait:r,trailing:c})}const vt=(n,r)=>{if(!W)return!1;const a={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(r)],o=Le(n,a);return["scroll","auto","overlay"].some(c=>o.includes(c))},pt=(n,r)=>{if(!W)return;let a=n;for(;a;){if([window,document,document.documentElement].includes(a))return window;if(vt(a,r))return a;a=a.parentNode}return a},gt=pe({urlList:{type:ie(Array),default:()=>ge([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),yt={close:()=>!0,switch:n=>fe(n)},wt=["src"],ht=se({name:"ElImageViewer"}),bt=se({...ht,props:gt,emits:yt,setup(n,{expose:r,emit:a}){const o=n,c={CONTAIN:{name:"contain",icon:de(Ce)},ORIGINAL:{name:"original",icon:de(Te)}},{t:h}=ye(),i=we("image-viewer"),{nextZIndex:v}=ze(),y=T(),b=T([]),k=xe(),p=T(!0),d=T(o.initialIndex),m=Se(c.CONTAIN),f=T({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),X=z(()=>{const{urlList:e}=o;return e.length<=1}),O=z(()=>d.value===0),$=z(()=>d.value===o.urlList.length-1),D=z(()=>o.urlList[d.value]),F=z(()=>{const{scale:e,deg:s,offsetX:u,offsetY:_,enableTransition:B}=f.value;let C=u/e,M=_/e;switch(s%360){case 90:case-270:[C,M]=[M,-C];break;case 180:case-180:[C,M]=[-C,-M];break;case 270:case-90:[C,M]=[-M,C];break}const H={transform:`scale(${e}) rotate(${s}deg) translate(${C}px, ${M}px)`,transition:B?"transform .3s":""};return m.value.name===c.CONTAIN.name&&(H.maxWidth=H.maxHeight="100%"),H}),U=z(()=>fe(o.zIndex)?o.zIndex:v());function x(){I(),a("close")}function l(){const e=oe(u=>{switch(u.code){case j.esc:o.closeOnPressEscape&&x();break;case j.space:G();break;case j.left:J();break;case j.up:A("zoomIn");break;case j.right:ee();break;case j.down:A("zoomOut");break}}),s=oe(u=>{const _=u.deltaY||u.deltaX;A(_<0?"zoomIn":"zoomOut",{zoomRate:o.zoomRate,enableTransition:!1})});k.run(()=>{Z(document,"keydown",e),Z(document,"wheel",s)})}function I(){k.stop()}function R(){p.value=!1}function P(e){p.value=!1,e.target.alt=h("el.image.error")}function Q(e){if(p.value||e.button!==0||!y.value)return;f.value.enableTransition=!1;const{offsetX:s,offsetY:u}=f.value,_=e.pageX,B=e.pageY,C=oe(H=>{f.value={...f.value,offsetX:s+H.pageX-_,offsetY:u+H.pageY-B}}),M=Z(document,"mousemove",C);Z(document,"mouseup",()=>{M()}),e.preventDefault()}function q(){f.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function G(){if(p.value)return;const e=He(c),s=Object.values(c),u=m.value.name,B=(s.findIndex(C=>C.name===u)+1)%e.length;m.value=c[e[B]],q()}function K(e){const s=o.urlList.length;d.value=(e+s)%s}function J(){O.value&&!o.infinite||K(d.value-1)}function ee(){$.value&&!o.infinite||K(d.value+1)}function A(e,s={}){if(p.value)return;const{zoomRate:u,rotateDeg:_,enableTransition:B}={zoomRate:o.zoomRate,rotateDeg:90,enableTransition:!0,...s};switch(e){case"zoomOut":f.value.scale>.2&&(f.value.scale=Number.parseFloat((f.value.scale/u).toFixed(3)));break;case"zoomIn":f.value.scale<7&&(f.value.scale=Number.parseFloat((f.value.scale*u).toFixed(3)));break;case"clockwise":f.value.deg+=_;break;case"anticlockwise":f.value.deg-=_;break}f.value.enableTransition=B}return le(D,()=>{he(()=>{const e=b.value[0];e!=null&&e.complete||(p.value=!0)})}),le(d,e=>{q(),a("switch",e)}),be(()=>{var e,s;l(),(s=(e=y.value)==null?void 0:e.focus)==null||s.call(e)}),r({setActiveItem:K}),(e,s)=>(L(),ue(De,{to:"body",disabled:!e.teleported},[g(Pe,{name:"viewer-fade",appear:""},{default:S(()=>[E("div",{ref_key:"wrapper",ref:y,tabindex:-1,class:w(t(i).e("wrapper")),style:ce({zIndex:t(U)})},[E("div",{class:w(t(i).e("mask")),onClick:s[0]||(s[0]=Ne(u=>e.hideOnClickModal&&x(),["self"]))},null,2),N(" CLOSE "),E("span",{class:w([t(i).e("btn"),t(i).e("close")]),onClick:x},[g(t(Y),null,{default:S(()=>[g(t(Oe))]),_:1})],2),N(" ARROW "),t(X)?N("v-if",!0):(L(),V(ae,{key:0},[E("span",{class:w([t(i).e("btn"),t(i).e("prev"),t(i).is("disabled",!e.infinite&&t(O))]),onClick:J},[g(t(Y),null,{default:S(()=>[g(t($e))]),_:1})],2),E("span",{class:w([t(i).e("btn"),t(i).e("next"),t(i).is("disabled",!e.infinite&&t($))]),onClick:ee},[g(t(Y),null,{default:S(()=>[g(t(Re))]),_:1})],2)],64)),N(" ACTIONS "),E("div",{class:w([t(i).e("btn"),t(i).e("actions")])},[E("div",{class:w(t(i).e("actions__inner"))},[g(t(Y),{onClick:s[1]||(s[1]=u=>A("zoomOut"))},{default:S(()=>[g(t(Ae))]),_:1}),g(t(Y),{onClick:s[2]||(s[2]=u=>A("zoomIn"))},{default:S(()=>[g(t(Be))]),_:1}),E("i",{class:w(t(i).e("actions__divider"))},null,2),g(t(Y),{onClick:G},{default:S(()=>[(L(),ue(Me(t(m).icon)))]),_:1}),E("i",{class:w(t(i).e("actions__divider"))},null,2),g(t(Y),{onClick:s[3]||(s[3]=u=>A("anticlockwise"))},{default:S(()=>[g(t(Ve))]),_:1}),g(t(Y),{onClick:s[4]||(s[4]=u=>A("clockwise"))},{default:S(()=>[g(t(Ye))]),_:1})],2)],2),N(" CANVAS "),E("div",{class:w(t(i).e("canvas"))},[(L(!0),V(ae,null,We(e.urlList,(u,_)=>Xe((L(),V("img",{ref_for:!0,ref:B=>b.value[_]=B,key:u,src:u,style:ce(t(F)),class:w(t(i).e("img")),onLoad:R,onError:P,onMousedown:Q},null,46,wt)),[[Fe,_===d.value]])),128))],2),te(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var kt=ke(bt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const It=Ie(kt),_t=pe({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:ie([String,Object])},previewSrcList:{type:ie(Array),default:()=>ge([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Et={load:n=>n instanceof Event,error:n=>n instanceof Event,switch:n=>fe(n),close:()=>!0,show:()=>!0},Lt=["src","loading"],Ct={key:0},Tt=se({name:"ElImage",inheritAttrs:!1}),zt=se({...Tt,props:_t,emits:Et,setup(n,{emit:r}){const a=n;let o="";const{t:c}=ye(),h=we("image"),i=je(),v=Qe(),y=T(),b=T(!1),k=T(!0),p=T(!1),d=T(),m=T(),f=W&&"loading"in HTMLImageElement.prototype;let X,O;const $=z(()=>i.style),D=z(()=>{const{fit:e}=a;return W&&e?{objectFit:e}:{}}),F=z(()=>{const{previewSrcList:e}=a;return Array.isArray(e)&&e.length>0}),U=z(()=>{const{previewSrcList:e,initialIndex:s}=a;let u=s;return s>e.length-1&&(u=0),u}),x=z(()=>a.loading==="eager"?!1:!f&&a.loading==="lazy"||a.lazy),l=()=>{W&&(k.value=!0,b.value=!1,y.value=a.src)};function I(e){k.value=!1,b.value=!1,r("load",e)}function R(e){k.value=!1,b.value=!0,r("error",e)}function P(){Je(d.value,m.value)&&(l(),G())}const Q=Ke(P,200);async function q(){var e;if(!W)return;await he();const{scrollContainer:s}=a;qe(s)?m.value=s:Ge(s)&&s!==""?m.value=(e=document.querySelector(s))!=null?e:void 0:d.value&&(m.value=pt(d.value)),m.value&&(X=Z(m,"scroll",Q),setTimeout(()=>P(),100))}function G(){!W||!m.value||!Q||(X==null||X(),m.value=void 0)}function K(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function J(){F.value&&(O=Z("wheel",K,{passive:!1}),o=document.body.style.overflow,document.body.style.overflow="hidden",p.value=!0,r("show"))}function ee(){O==null||O(),document.body.style.overflow=o,p.value=!1,r("close")}function A(e){r("switch",e)}return le(()=>a.src,()=>{x.value?(k.value=!0,b.value=!1,G(),q()):l()}),be(()=>{x.value?q():l()}),(e,s)=>(L(),V("div",{ref_key:"container",ref:d,class:w([t(h).b(),e.$attrs.class]),style:ce(t($))},[b.value?te(e.$slots,"error",{key:0},()=>[E("div",{class:w(t(h).e("error"))},Ze(t(c)("el.image.error")),3)]):(L(),V(ae,{key:1},[y.value!==void 0?(L(),V("img",Ue({key:0},t(v),{src:y.value,loading:e.loading,style:t(D),class:[t(h).e("inner"),t(F)&&t(h).e("preview"),k.value&&t(h).is("loading")],onClick:J,onLoad:I,onError:R}),null,16,Lt)):N("v-if",!0),k.value?(L(),V("div",{key:1,class:w(t(h).e("wrapper"))},[te(e.$slots,"placeholder",{},()=>[E("div",{class:w(t(h).e("placeholder"))},null,2)])],2)):N("v-if",!0)],64)),t(F)?(L(),V(ae,{key:2},[p.value?(L(),ue(t(It),{key:0,"z-index":e.zIndex,"initial-index":t(U),infinite:e.infinite,"zoom-rate":e.zoomRate,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:ee,onSwitch:A},{default:S(()=>[e.$slots.viewer?(L(),V("div",Ct,[te(e.$slots,"viewer")])):N("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):N("v-if",!0)],64)):N("v-if",!0)],6))}});var xt=ke(zt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const Ot=Ie(xt);export{Ot as E};
