import{U as g,d as E,l as $,e as d,I as x,o as i,c as _,a as e,f as C,w as y,V as w,h as k,J as F,_ as D,t as I,F as N,r as M,b as A,D as L,v as b,j as P,x as H,P as B,p as z,k as J,u as j}from"./index-2f76c9d1.js";import{g as q}from"./article-c306d2f9.js";import"./base-01c19deb.js";import{E as G}from"./el-image-viewer-36270aa2.js";import"./scroll-11f16d90.js";const K=o=>g("/treehole/comment/sendComment",{method:"post",data:o}),Q=o=>g("/treehole/comment/commentList",{method:"get",params:o}),W={class:"comment-input"},X={class:"avatar"},Y=["src"],Z=E({__name:"CommentInput",props:{articleuuid:{default:""},toUserUUID:{default:""},toUserName:{default:""},fatherCommentUUID:{default:""}},emits:["successComment"],setup(o,{emit:v}){const r=o,n=$(),c="留下你精彩的评论吧",s=d(""),p=d(!1),m=d(!1);x(s,(U,u)=>{U?m.value=!0:m.value=!1});const f=async()=>{var U,u,t;if(s.value=="")F({message:"评论不能为空",type:"warning"});else{const l=s.value,a={AVATAR:(U=n.userInfo)==null?void 0:U.AVATAR,COMMENT:l,ADD_TIME:"刚刚",ACCOUNT:(u=n.userInfo)==null?void 0:u.ACCOUNT,COMMENT_UUID:Date.now()+"",ARTICLE_UUID:r.articleuuid,USER_UUID:(t=n.userInfo)==null?void 0:t.USER_UUID,USERINFO:{ACCOUNT:r.toUserName,AVATAR:""}};await K({to_user_uuid:r.toUserUUID,father_comment_uuid:r.fatherCommentUUID,comment:l,article_uuid:r.articleuuid}),s.value="",p.value=!0,v("successComment",a)}};return(U,u)=>{var t;return i(),_("div",W,[e("div",X,[e("img",{src:(t=C(n).userInfo)==null?void 0:t.AVATAR,alt:""},null,8,Y)]),y(e("input",{placeholder:c,class:"comment_input","onUpdate:modelValue":u[0]||(u[0]=l=>s.value=l),ref:"content"},null,512),[[w,s.value]]),e("div",{class:k(["comment_input_right",m.value?"can-send":"not-can-send"]),onClick:f}," 发送 ",2)])}}});const V=D(Z,[["__scopeId","data-v-4e0bb45e"]]),ee={class:"acticle-info"},te={class:"left"},se=["src"],oe={class:"right"},ne={class:"name"},ce={class:"time"},ae={class:"content"},le=["innerHTML"],ie={class:"imgs"},_e=E({__name:"ArticleInfo",props:{articleInfo:null},setup(o){return(v,r)=>{const n=G;return i(),_("div",ee,[e("div",te,[e("div",null,[e("img",{src:o.articleInfo.AVATAR},null,8,se)])]),e("div",oe,[e("div",ne,I(o.articleInfo.ACCOUNT),1),e("div",ce,I(o.articleInfo.UPDATE_TIME||o.articleInfo.ADD_TIME),1),e("div",ae,[e("p",{innerHTML:o.articleInfo.CONTENT},null,8,le)]),e("div",ie,[(i(!0),_(N,null,M(o.articleInfo.PICS,(c,s)=>(i(),_("div",{key:s,class:"img-box"},[A(n,{class:"img-item",fit:"cover",src:c.url,"preview-src-list":[c.url],"zoom-rate":1.1},null,8,["src","preview-src-list","zoom-rate"])]))),128))])])])}}});const re=D(_e,[["__scopeId","data-v-e9fa2589"]]),me={class:"left"},ue={class:"avatar"},de=["src"],Ue={class:"right"},Ce={class:"name"},Ie={key:0,class:"at"},ve={class:"comment"},pe={class:"tool"},Ae={class:"tool-item time"},fe=["onClick"],he=E({__name:"CommentMinorList",props:{commentList:null},emits:["minorReply"],setup(o,{emit:v}){const r=n=>{v("minorReply",n.FATHER_COMMENT_UUID,n.USER_UUID,n.ACCOUNT)};return(n,c)=>(i(),_("div",null,[(i(!0),_(N,null,M(o.commentList,(s,p)=>(i(),_("div",{class:"comment-item",key:p},[e("div",me,[e("div",ue,[e("img",{src:s.AVATAR,alt:""},null,8,de)])]),e("div",Ue,[e("div",null,[e("span",Ce,I(s.ACCOUNT),1),s.USERINFO?(i(),_("span",Ie,"@"+I(s.USERINFO.ACCOUNT)+" ：",1)):L("",!0),e("span",ve,I(s.COMMENT),1)]),e("div",pe,[e("span",Ae,I(n.$common.timeFilter(s.ADD_TIME)),1),e("span",{class:"tool-item reply",onClick:m=>r(s)},"回复",8,fe)])])]))),128))]))}});const Te=D(he,[["__scopeId","data-v-5c2e2631"]]),Ee={class:"commont-list"},De={class:"left"},Ne={class:"avatar"},Me=["src"],Re={class:"right"},Oe={class:"name"},Se={class:"content"},ge={class:"tool"},$e={class:"tool-item time"},ye=["onClick"],Le={key:0,style:{"margin-left":"0px","padding-top":"10px"}},Ve=E({__name:"CommontList",props:{commentList:null,articleuuid:null},emits:["minorSuccessComment"],setup(o,{emit:v}){const r=o,n=$();let c=d(),s=d(""),p=d(""),m=d("");const f=t=>{c.value?c.value="":(c.value=t.COMMENT_UUID,s.value="",m.value=t.COMMENT_UUID)},U=(t,l,a)=>{c.value?c.value="":(c.value=t,s.value=l,p.value=a,m.value=t)},u=(t,l)=>{var h,T,R,O,S;const a={AVATAR:(h=n.userInfo)==null?void 0:h.AVATAR,COMMENT:l.COMMENT,ADD_TIME:"刚刚",ACCOUNT:(T=n.userInfo)==null?void 0:T.ACCOUNT,COMMENT_UUID:Date.now()+"",ARTICLE_UUID:r.articleuuid,USER_UUID:(R=n.userInfo)==null?void 0:R.USER_UUID,TO_USER_UUID:l.TO_USER_UUID,FATHER_COMMENT_UUID:l.FATHER_COMMENT_UUID,USERINFO:{ACCOUNT:(O=l.USERINFO)==null?void 0:O.ACCOUNT,AVATAR:(S=l.USERINFO)==null?void 0:S.AVATAR}};v("minorSuccessComment",t,a)};return(t,l)=>(i(),_("div",Ee,[(i(!0),_(N,null,M(o.commentList,(a,h)=>(i(),_("div",{class:"comment-item",key:h},[e("div",De,[e("div",Ne,[e("img",{src:a.AVATAR,alt:""},null,8,Me)])]),e("div",Re,[e("div",Oe,I(a.ACCOUNT),1),e("div",Se,I(a.COMMENT),1),e("div",ge,[e("span",$e,I(t.$common.timeFilter(a.ADD_TIME)),1),e("span",{class:"tool-item reply",onClick:T=>f(a)},"回复",8,ye)]),a.childComment?(i(),_("div",Le,[A(Te,{onMinorReply:U,commentList:a.childComment},null,8,["commentList"])])):L("",!0),y(A(V,{class:"minor-reply",onSuccessComment:T=>{u(h,T)},articleuuid:a.ARTICLE_UUID,toUserUUID:C(s),toUserName:C(p),fatherCommentUUID:C(m)},null,8,["onSuccessComment","articleuuid","toUserUUID","toUserName","fatherCommentUUID"]),[[b,C(c)===a.COMMENT_UUID]])])]))),128))]))}});const xe=D(Ve,[["__scopeId","data-v-f37f59fd"]]),we=o=>(z("data-v-b1616186"),o=o(),J(),o),ke={class:"article-detail"},Fe=we(()=>e("i",{class:"iconfont icon-fanhui"},null,-1)),be={class:"comment-box"},Pe=E({__name:"IndexView",setup(o){const v=j(),r=B();let n=d(""),c=d([]),s=d({ACCOUNT:"",ADD_TIME:"",ARTICLE_UUID:"",AVATAR:"",CONTENT:"",PICS:"",TITLE:"",UPDATE_TIME:""});const p=()=>{v.go(-1)};P(()=>{n.value=r.params.id,f(),m()});const m=async()=>{const t=await Q({article_uuid:n.value});c.value=t.data},f=async()=>{const t=await q({article_uuid:n.value});t.data.PICS=JSON.parse(t.data.PICS),s.value=t.data},U=async t=>{c.value.unshift(t)},u=async(t,l)=>{var a;(a=c.value[t].childComment)==null||a.push(l)};return(t,l)=>(i(),_("div",ke,[e("div",{class:"back",onClick:p},[Fe,H("返回")]),A(re,{articleInfo:C(s)},null,8,["articleInfo"]),e("div",be,[A(V,{onSuccessComment:U,articleuuid:C(n)},null,8,["articleuuid"])]),A(xe,{commentList:C(c),articleuuid:C(n),onMinorSuccessComment:u},null,8,["commentList","articleuuid"])]))}});const qe=D(Pe,[["__scopeId","data-v-b1616186"]]);export{qe as default};
